//import com.gradle.plugin.CustomPluginBuildSrc

apply from: "${rootDir}/buildApp.gradle"
apply from: "${rootDir}/learn.gradle"
apply plugin: 'org.greenrobot.greendao'
//apply plugin: CustomPluginBuildSrc
apply plugin: 'com.google.gms.google-services'
apply plugin: 'com.google.firebase.crashlytics'

android {
    defaultConfig {
        versionCode 10000
        versionName "1.0.0"
        javaCompileOptions {
            annotationProcessorOptions {
                arguments = [ eventBusIndex : 'com.example.myapp.MyEventBusIndex' ]
            }
        }
        vectorDrawables.useSupportLibrary = true
    }

    buildTypes {
        debug {
            ndk {
//                abiFilters "armeabi"
            }
        }
        internal{
            initWith debug
        }
    }

    flavorDimensions "mode"
    /*productFlavors {
        getThisObject().properties.clear()
        this.properties.clear()
        development {
            // 避免使用 Legacy Multidex 以加快编译，注意：实际开发中，IDE 判断的最小sdk会变成这个
            // 避免使用 Legacy Multidex 以加快编译，注意：实际开发中，IDE 判断的最小sdk会变成这个
//            minSdkVersion Android.minDebugSdkVersion
            resConfigs("xhdpi", "pt", "en")
        }

        product {
            applicationId "cn.dozyx.app.product"
        }
    }*/
    sourceSets {
        // https://stackoverflow.com/questions/41507389/unresolved-reference-daosession-using-greendao-and-kotlin
        main.java.srcDirs += 'build/generated/source/greendao'
    }
    viewBinding {
        enabled true
    }
}
greendao {
    schemaVersion 3 // 版本号，所有 greenDao 的数据库会共享，可以在生成的 DaoMaster 里看到这个版本号
    // 如果 Entity 类增加了字段，但没有在
}

dependencies {
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation project(':model')
    implementation project(':core')
    implementation project(':ui')
    implementation libs.constraintLayout
    implementation libs.legacySupportV4
    implementation libs.appcompat
    implementation libs.butterknife.runtime
    implementation 'androidx.work:work-runtime-ktx:2.7.1'
    implementation 'androidx.work:work-rxjava2:2.7.1'
    annotationProcessor libs.butterknife.processor
    implementation libs.percentlayout
    implementation libs.universalImageLoader
    implementation libs.material
    implementation libs.volley
    implementation libs.okhttp.runtime
    implementation libs.okhttp.logging
    implementation libs.retrofit.runtime
    implementation libs.retrofit.gson
    implementation libs.retrofit.rxjavaAdapter
    implementation libs.retrofit.rxjava3Adapter
    implementation libs.rxjava2
    implementation libs.eventbus.core
    annotationProcessor libs.eventbus.processor
    implementation libs.kotlin
    implementation libs.lifecycle
    implementation libs.annotations
    implementation libs.flexbox
    implementation libs.dagger.runtime
    annotationProcessor libs.dagger.processor
    implementation libs.mpAndroidChart
    implementation libs.rxlifecycle.android
    implementation libs.barUtil
    implementation libs.utilcode
    implementation libs.rxpermissions
    kapt libs.room.processor
    implementation libs.room.runtime
    implementation libs.room.rxjava2
    implementation libs.stetho
    implementation libs.camera.camera2
    implementation libs.picasso
    implementation libs.timber
    implementation libs.retrofit.scalars
    implementation libs.material
    implementation libs.adapterHelper
    implementation libs.calligraphy
    implementation libs.viewpump
    implementation libs.glide.runtime
    implementation libs.paging.runtime
    implementation libs.paging.rxjava2
    implementation libs.immersionbar
    implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.6.0'
    implementation libs.circleImageView
    implementation libs.greendao
    implementation libs.startup
    implementation libs.tracing
    compile 'com.google.firebase:perf-plugin:1.4.0'
//    compile 'com.jakewharton.hugo:hugo-plugin:1.2.1'
//    compileOnly 'com.android.tools.build:gradle:3.6.1' // 一样会导致运行报错，暂时没找原因 The given artifact contains a string literal with a package reference 'android.support.design.widget' that cannot be safely rewritten.
//    compile 'com.android.tools.build:gradle:3.5.2'// 这个版本跟 androidx 冲突，会导致项目没办法运行，但 sync 正常。。。
    implementation libs.exoplayer
    implementation libs.exoplayer.okhttp
    implementation libs.core.ktx
    implementation libs.lottie
    implementation libs.process.phoenix
    implementation libs.gp.auth
    implementation libs.tooltip
    implementation libs.materialprogressbar
    implementation libs.notchScreenTool
    implementation libs.rxjava3
    implementation libs.androix.media
    implementation libs.androidx.activity
    implementation libs.okio
    implementation libs.webview.inspector
    debugImplementation(libs.doraemonkit.dokitx) {
        exclude group: 'com.blankj'
    }
    releaseImplementation libs.doraemonkit.dokitxnoop
    debugImplementation libs.flipper.flipper
    debugImplementation libs.flipper.soloader
    releaseImplementation libs.flipper.flipper.noop

    // 设置了 bom 之后，Firebase 其他模块不需要指定版本
    implementation platform('com.google.firebase:firebase-bom:28.1.0')
    implementation 'com.google.firebase:firebase-analytics'
    implementation 'com.google.firebase:firebase-crashlytics'
    implementation 'com.google.firebase:firebase-messaging'
    implementation 'net.dongliu:apk-parser:2.2.0'
    implementation files('libs/extension-av1-v7a.aar')
}
